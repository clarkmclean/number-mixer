<!DOCTYPE html>

<html class="skrollr skrollr-desktop">
<head>
<title>Number Mixer!  Mix some numbers...</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="javascripts/jquery.sortable.js"></script>
<link href='http://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
<link href="stylesheets/style.css" rel="stylesheet" type="text/css">
</head>
<body>
<style>
	html,body{
		font-family: 'Roboto Slab', serif;
		z-index: 0;
		height: 100%;
		background: #ddd;
	}

	.btn {
	  background: #d93434;
	  background-image: -webkit-linear-gradient(top, #d93434, #b82b2b);
	  background-image: -moz-linear-gradient(top, #d93434, #b82b2b);
	  background-image: -ms-linear-gradient(top, #d93434, #b82b2b);
	  background-image: -o-linear-gradient(top, #d93434, #b82b2b);
	  background-image: linear-gradient(to bottom, #d93434, #b82b2b);
	  -webkit-border-radius: 3;
	  -moz-border-radius: 3;
	  border-radius: 3px;
	  color: #ffffff;
	  font-size: 20px;
	  padding: 10px 20px 10px 20px;
	  text-decoration: none;
	  cursor: pointer;r;
	}

	.btn:hover{
		background: #d93434 !important;
		/*box-shadow: inset 0 0 10px #bbb;
		color: #333;*/
	}

	.block{
		/*this will need to get set by javascript depending on board size*/
		width: 10%;
		height: 20%;
		float: left;
		margin: 0;
		box-shadow: 1px 1px #333;
	}

	#boardWrapper{
		width: 100%;
		height: calc(100% - 60px);
		position: relative;
		top: 50px;

	}

	#board{
		width: 100vw; 
	    height: calc(56.25vw - 100px); /* 100/56.25 = 1.778 */
	    max-height: calc(100vh - 100px);
	    max-width: 177.78vh; /* 16/9 = 1.778 */
	    margin: auto;
	    position: absolute;
	    top:0px;bottom:0; /* vertical center */
	    left:0;right:0; /* horizontal center */
	}

	.piece{
		width: 90%;
		height: 90%;
		margin: 5%;
		cursor: pointer;
		transform: scale(-4px);
		-moz-animation-name: dropHeader;
	    -moz-animation-iteration-count: 1;
	    -moz-animation-timing-function: ease-in-out;
	    -moz-animation-duration: 0.3s;

	    -webkit-animation-name: dropHeader;
	    -webkit-animation-iteration-count: 1;
	    -webkit-animation-timing-function: ease-in-out;
	    -webkit-animation-duration: 0.3s;

	    animation-name: dropHeader;
	    animation-iteration-count: 1;
	    animation-timing-function: ease-in-out;
	    animation-duration: 0.3s;
	}

	@-moz-keyframes dropHeader {
	    0% {
	        -moz-transform: translateY(-40px);
	    }
	    100% {
	        -moz-transform: translateY(0);
	    }
	}
	@-webkit-keyframes dropHeader {
	    0% {
	        -webkit-transform: scale(.5);
	    }
	    90% {
	        -webkit-transform: scale(1.055);
	    }
	    100% {
	    	-webkit-transform: scale(1);
	    }
	}
	@keyframes dropHeader {
	    0% {
	        transform: scale(-40px);
	    }
	    100% {
	        transform: scale(0);
	    }
	}

	.piece:before{
		content: attr(data-number);
		font-size: 70px;
		line-height: 0px;
		position: relative; 
		top: calc(50%); 
	}

	.red{
		background-color: red;
	}

	.green{
		background-color: green;
	}

	.blue{
		background-color: blue;
	}

	.yellow{
		background-color: yellow;
	}

	.blank{
		background-color: #aaa;
		color: #aaa;
	}
</style>
<script>
$(function(){
	//some defaults
	var rowLength = 9;
	var pieceTypes = 4;
	var numOfBlanks = (rowLength+1) + pieceTypes;
	var numOfPieces = (rowLength+1) * (pieceTypes + 1);
	var colorsArray = ['green','blue','red','yellow'];


	//board array
	var pieces = [];
	//create arrays of numbers
	// 4 colors and 1 of blanks or 5 arrays total
	var blank = [];
	var green = [];
	var blue = []
	var red = [];
	var yellow = [];

	$(document).on('click','#startGame', function(){
		startGame();
	});

	function startGame(){
		$('#startGame').addClass('hide');
		$('#boardWrapper').append(buildBoard());
		setTimeout(populateBoard(), 500);
		animatePieces();
	}
	function buildBoard(){
		var html = [];
		html.push('<div id="board" class="flush-full">');
		for(var i = 1; i <= 5; i++){
				for(var j = 1; j <= 10; j++){
					html.push('<div class="block ' + i +'"></div>');
				}
		}
		html.push('</div>')
		return html.join("");
	}
	function populateBoard(){
		// 4 colors
		pieces.push(green,blue,red,yellow);
		// 9 numbers per colors
		for(var i = 0; i < pieces.length;i++){
			for(var j = 1; j <= rowLength; j++){
				pieces[i].push(j);
			}
		}
		console.log(pieces);
		// blanks
		for(var i = 1; i <= numOfBlanks;i++){
			blank.push(i);
		}
		// ad them to master array and colors array
		pieces.push(blank);
		colorsArray.push('blank');

		console.log(pieces);

		//put everything in the board
		//select by index of <td>
		//randomly select from multidimensional array
		//make sure to delete from array every time. delete from top level once empty
		var x = 0
		var intervalId = setInterval(function(){
			placePiece(x);
			if(++x === numOfPieces){
				window.clearInterval(intervalId);
			}
		}, 25);

	}
	function placePiece(index){
		// random number of piece color
		var num1 = Math.floor(Math.random() * pieces.length);
		// use random type to pick color in array and get color string from color array
		var randType = pieces[num1];
		var color = colorsArray[num1];
		// random number for piece number
		var num2 = Math.floor(Math.random() * randType.length);
		// get piece from array
		var indPiece = randType[num2];
		// get color string from color array
		

		var pieceHtml = '<div class="piece ' + color + '" data-number="' + randType[num2] + '"></div>';

		$('.block:eq(' + index + ')').append(pieceHtml);
		randType.splice(num2, 1);
		console.log(color + ' ' + randType.length + ' : ' + num1 + '/' + num2);
		if(randType.length == 0){
			pieces.splice(num1,1);
			colorsArray.splice(num1,1);
		}
	}
});
</script>
<h1 class="tc" style="margin-bottom:30px;">Number Mixer</h1>
<div id="wrapper" class="tc" style="position:fixed; height: 100%; width: 100%;">
<div id="boardWrapper"></div>
	<span id="startGame" class="btn mobile-full" style="position: relative; top: 40%; transform: translateY(-40%); width: 300px; display: inline-block;">Start New Game!</span>

</div>
</body>
</html>